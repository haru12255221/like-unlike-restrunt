# 一瞥（いちべつ）- 実装タスク

## 実装方針

テスト戦略から逆算し、テスト駆動開発（TDD）アプローチで実装を進めます。各タスクでは「テスト → 実装 → リファクタリング」のサイクルを繰り返し、確実に動作する機能を段階的に構築します。

## タスク一覧

- [x] 1. プロジェクト基盤とテスト環境の構築
  - Next.js 14プロジェクトの初期化とTailwind CSS設定
  - テストライブラリ（Jest, React Testing Library）の導入
  - Framer Motionとデザインシステムの基盤構築
  - _要件: 5.1, 5.2_

- [x] 2. 店舗データモデルとテストデータの作成
  - 店舗データの型定義とJSONファイル作成
  - テスト用の店舗データセット準備
  - データ取得関数の実装とテスト
  - _要件: 3.1, 3.2, 5.1_

- [x] 3. 基本UIコンポーネントの実装（TDD）
  - [x] 3.1 Buttonコンポーネントの実装
    - ボタンのテストケース作成（variant別、クリックイベント）
    - Buttonコンポーネントの実装
    - 和風デザインシステムの適用
    - _要件: 3.1_

  - [x] 3.2 Cardコンポーネントの実装
    - カードのテストケース作成（swipe/list variant）
    - Cardコンポーネントの実装
    - 画像表示とフォールバック処理
    - _要件: 3.1, 3.2_

  - [x] 3.3 レイアウトコンポーネントの実装
    - Container、FlexCenterコンポーネントのテスト
    - レスポンシブレイアウトの実装
    - モバイルファーストデザインの適用
    - _要件: 3.1_

- [ ] 4. 認証機能の実装（TDD）
  - [ ] 4.1 NextAuth.js設定とGoogle認証
    - 認証フローのテストケース作成
    - NextAuth.js設定とGoogle Provider設定
    - ログイン/ログアウト機能の実装
    - _要件: 1.1, 1.2, 1.3_

  - [ ] 4.2 認証状態管理とプロテクト機能
    - 認証状態のテストケース作成
    - useSessionフックの活用
    - 未認証時のリダイレクト処理
    - _要件: 1.1, 1.2, 1.3_

- [ ] 5. Like機能とローカルストレージ管理（TDD）
  - [ ] 5.1 Like状態管理の実装
    - Like操作のテストケース作成（追加、削除、取得）
    - LocalStorageを使ったLike履歴管理
    - カスタムフック（useLikes）の実装
    - _要件: 4.1, 4.2, 4.3_

  - [ ] 5.2 Like操作のエラーハンドリング
    - エラーケースのテスト（LocalStorage失敗など）
    - 一時保存とリトライ機能の実装
    - エラートースト表示の実装
    - _要件: 4.1, 4.4_

- [ ] 6. スワイプカード機能の実装（TDD）
  - [ ] 6.1 基本的なスワイプ検出
    - スワイプ判定ロジックのテスト
    - Framer Motionを使ったドラッグ検出
    - 左右スワイプの判定実装
    - _要件: 2.2, 2.3, 2.4_

  - [ ] 6.2 スワイプアニメーションの実装
    - アニメーションのテスト（モック使用）
    - カードの回転とフェードアウト効果
    - スワイプ失敗時の元位置復帰
    - _要件: 2.2, 2.3, 2.5_

  - [ ] 6.3 カードスタック機能の実装
    - 複数カード表示のテスト
    - カードの重なり表示とz-index管理
    - 次のカードへの自動遷移
    - _要件: 2.1, 2.5_

- [ ] 7. ホーム画面の実装（TDD）
  - [ ] 7.1 店舗カード表示機能
    - 店舗データ表示のテスト
    - SwipeCardコンポーネントの統合
    - 画像読み込みエラーの処理
    - _要件: 2.1, 3.1, 3.3_

  - [ ] 7.2 スワイプ操作の統合
    - スワイプイベントハンドリングのテスト
    - Like/Skip操作の実装
    - 店舗詳細ページへの遷移（タップ）
    - _要件: 2.2, 2.3, 2.4_

  - [ ] 7.3 全店舗表示完了時の処理
    - 終了状態のテスト
    - 「すべての店舗を見終わりました」メッセージ表示
    - リセット機能の実装
    - _要件: 2.5_

- [ ] 8. Like一覧ページの実装（TDD）
  - [ ] 8.1 Like履歴表示機能
    - Like一覧表示のテスト
    - グリッドレイアウトの実装
    - 空状態の処理
    - _要件: 4.1, 4.2, 4.3_

  - [ ] 8.2 ページ遷移アニメーション
    - ページ遷移のテスト（アニメーションモック）
    - Framer Motionを使った順次表示アニメーション
    - staggerChildrenの実装
    - _要件: 4.1, 4.6_

- [ ] 9. 店舗詳細ページの実装（TDD）
  - [ ] 9.1 詳細情報表示機能
    - 店舗詳細表示のテスト
    - 画像、店名、ジャンル、住所、ストーリーの表示
    - 戻るボタンの実装
    - _要件: 3.1, 3.2, 3.3_

  - [ ] 9.2 詳細ページのアニメーション
    - ページ遷移アニメーションのテスト
    - フェードイン・スケールアニメーション
    - 戻る時のアニメーション
    - _要件: 3.1_

- [ ] 10. ナビゲーション機能の実装（TDD）
  - [ ] 10.1 下部ナビゲーションの実装
    - ナビゲーションのテスト（ページ切り替え）
    - ホーム/Like一覧の切り替え機能
    - アクティブ状態の表示
    - _要件: 4.1, 4.6_

  - [ ] 10.2 ページルーティングの実装
    - ルーティングのテスト
    - Next.js App Routerの活用
    - 認証が必要なページの保護
    - _要件: 1.1, 4.6_

- [ ] 11. エラーハンドリングの実装（TDD）
  - [ ] 11.1 エラーUIコンポーネントの実装
    - エラー表示のテスト（Toast、ErrorBoundary）
    - エラー種別に応じたUI表示
    - リトライ機能の実装
    - _要件: 全般_

  - [ ] 11.2 グローバルエラーハンドリング
    - 未処理エラーのテスト
    - エラーログ記録機能
    - ユーザーフレンドリーなエラーメッセージ
    - _要件: 全般_

- [ ] 12. パフォーマンス最適化とアクセシビリティ（TDD）
  - [ ] 12.1 画像最適化とローディング
    - 画像読み込みのテスト
    - Next.js Imageコンポーネントの活用
    - ローディング状態の表示
    - _要件: 3.3_

  - [ ] 12.2 アクセシビリティ対応
    - キーボード操作のテスト
    - スクリーンリーダー対応
    - ARIA属性の適用
    - _要件: 全般_

- [ ] 13. E2Eテストの実装
  - [ ] 13.1 主要フローのE2Eテスト
    - ログイン → スワイプ → Like一覧のフロー
    - 店舗詳細表示のフロー
    - エラーケースのテスト
    - _要件: 全般_

  - [ ] 13.2 パフォーマンステスト
    - ページ読み込み速度のテスト
    - アニメーション性能のテスト
    - メモリリークのチェック
    - _要件: 全般_

- [ ] 14. 本番デプロイ準備
  - [ ] 14.1 環境変数とビルド設定
    - 本番環境用の設定
    - 環境変数の設定
    - ビルドエラーの修正
    - _要件: 全般_

  - [ ] 14.2 Vercelデプロイとテスト
    - Vercelへのデプロイ
    - 本番環境でのテスト
    - パフォーマンス監視の設定
    - _要件: 全般_